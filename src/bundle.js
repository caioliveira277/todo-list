const todoList=document.querySelector("#todo-list"),todoInput=document.querySelector("#todo-input"),todoButton=document.querySelector("#todo-button"),filterOption=document.querySelector("#filter-todo"),songs=document.querySelectorAll("audio");function PlaySong(a){songs.forEach(b=>{b.getAttribute("data-type")===a&&(b.currentTime=.2,b.play())})}function UpdateTitle(a=!0){const b=parseInt(document.title);if(!0===a)document.title=`${b+1} Tarefas em aberto`;else{if(0===b)return;document.title=`${b+-1} Tarefas em aberto`}}function CreateTodoDiv(a,b=!1){const c=document.createElement("div");c.classList.add("todo");const d=document.createElement("li");d.innerText=a,d.classList.add("todo-item");const e=document.createElement("button");e.innerHTML="<i class='material-icons'>check</i>",e.setAttribute("data-action","completed");const f=document.createElement("button");return f.innerHTML="<i class='material-icons'>delete</i>",f.setAttribute("data-action","delete"),c.appendChild(d),c.appendChild(e),c.appendChild(f),!0===b&&c.classList.add("completed"),c}function AddTodo(a){return a.preventDefault(),!!todoInput.value&&void(PlaySong("add"),todoList.appendChild(CreateTodoDiv(todoInput.value)),SaveTodo(todoInput.value),todoInput.value="",UpdateTitle(!0))}function HandlerActions(a){const b=a.target,c=b.closest("div.todo");let d;return"delete"===b.getAttribute("data-action")?(d=[...c.parentNode.children].indexOf(c),c.classList.add("fall"),DeleteTodo(c),PlaySong("remove"),UpdateTitle(!1),c.classList.contains("completed")||DeleteCompletedTodo(d),c.addEventListener("transitionend",()=>{c.remove()})):void("completed"===b.getAttribute("data-action")&&(d=[...c.parentNode.children].indexOf(c),c.classList.toggle("completed")?(SaveCompletedTodo(d),UpdateTitle(!1)):(DeleteCompletedTodo(d),UpdateTitle(!0))))}function FilterTodo(a){const b=todoList.childNodes;b.forEach(b=>{switch(a.target.value){case"all":b.style.display="flex";break;case"completed":b.style.display=b.classList.contains("completed")?"flex":"none";break;case"uncompleted":b.style.display=b.classList.contains("completed")?"none":"flex";}})}function SaveTodo(a){let b=[];localStorage.getItem("todos")&&(b=JSON.parse(localStorage.getItem("todos"))),b.push(a),localStorage.setItem("todos",JSON.stringify(b))}function DeleteTodo(a){let b=[];localStorage.getItem("todos")&&(b=JSON.parse(localStorage.getItem("todos")));const c=a.children[0].innerText;b.splice(b.indexOf(c),1),localStorage.setItem("todos",JSON.stringify(b))}function SaveCompletedTodo(a){let b=[];localStorage.getItem("completeds")&&(b=JSON.parse(localStorage.getItem("completeds"))),b.push(a),localStorage.setItem("completeds",JSON.stringify(b))}function DeleteCompletedTodo(a){let b=[];localStorage.getItem("completeds")&&(b=JSON.parse(localStorage.getItem("completeds"))),b.splice(b.indexOf(a),1),localStorage.setItem("completeds",JSON.stringify(b))}function GetTodos(){let a=[],b=[];localStorage.getItem("todos")&&(a=JSON.parse(localStorage.getItem("todos"))),localStorage.getItem("completeds")?(b=JSON.parse(localStorage.getItem("completeds")),document.title=`${a.length-b.length} Tarefas em aberto`):document.title=`0 Tarefas em aberto`,a.forEach((a,c)=>{-1===b.indexOf(c)?todoList.appendChild(CreateTodoDiv(a)):todoList.appendChild(CreateTodoDiv(a,!0))})}document.addEventListener("DOMContentLoaded",GetTodos),todoButton.addEventListener("click",AddTodo),todoList.addEventListener("click",HandlerActions),filterOption.addEventListener("change",FilterTodo);