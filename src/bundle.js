const todoList=document.querySelector("#todo-list"),todoInput=document.querySelector("#todo-input"),todoButton=document.querySelector("#todo-button"),filterOption=document.querySelector("#filter-todo"),songs=document.querySelectorAll("audio");function PlaySong(e){songs.forEach(t=>{t.getAttribute("data-type")===e&&(t.currentTime=.2,t.play())})}function UpdateTitle(e=!0){const t=parseInt(document.title);document.title=!0===e?`${t+1} Tarefas em aberto`:`${t+-1} Tarefas em aberto`}function CreateTodoDiv(e,t=!1){const o=document.createElement("div");o.classList.add("todo");const d=document.createElement("li");d.innerText=e,d.classList.add("todo-item");const l=document.createElement("button");l.innerHTML="<i class='material-icons'>check</i>",l.setAttribute("data-action","completed");const a=document.createElement("button");return a.innerHTML="<i class='material-icons'>delete</i>",a.setAttribute("data-action","delete"),o.appendChild(d),o.appendChild(l),o.appendChild(a),!0===t&&o.classList.add("completed"),o}function AddTodo(e){if(e.preventDefault(),!todoInput.value)return!1;PlaySong("add"),todoList.appendChild(CreateTodoDiv(todoInput.value)),SaveTodo(todoInput.value),todoInput.value="",UpdateTitle(!0)}function HandlerActions(e){const t=e.target,o=t.closest("div.todo");let d;if("delete"===t.getAttribute("data-action"))return d=[...o.parentNode.children].indexOf(o),o.classList.add("fall"),DeleteCompletedTodo(d),DeleteTodo(o),PlaySong("remove"),UpdateTitle(!1),o.addEventListener("transitionend",()=>{o.remove()});"completed"===t.getAttribute("data-action")&&(d=[...o.parentNode.children].indexOf(o),o.classList.toggle("completed")?(SaveCompletedTodo(d),UpdateTitle(!1)):(DeleteCompletedTodo(d),UpdateTitle(!0)))}function FilterTodo(e){todoList.childNodes.forEach(t=>{switch(e.target.value){case"all":t.style.display="flex";break;case"completed":t.classList.contains("completed")?t.style.display="flex":t.style.display="none";break;case"uncompleted":t.classList.contains("completed")?t.style.display="none":t.style.display="flex"}})}function SaveTodo(e){let t=[];localStorage.getItem("todos")&&(t=JSON.parse(localStorage.getItem("todos"))),t.push(e),localStorage.setItem("todos",JSON.stringify(t))}function DeleteTodo(e){let t=[];localStorage.getItem("todos")&&(t=JSON.parse(localStorage.getItem("todos")));const o=e.children[0].innerText;t.splice(t.indexOf(o),1),localStorage.setItem("todos",JSON.stringify(t))}function SaveCompletedTodo(e){let t=[];localStorage.getItem("completeds")&&(t=JSON.parse(localStorage.getItem("completeds"))),t.push(e),localStorage.setItem("completeds",JSON.stringify(t))}function DeleteCompletedTodo(e){let t=[];localStorage.getItem("completeds")&&(t=JSON.parse(localStorage.getItem("completeds"))),t.splice(t.indexOf(e),1),localStorage.setItem("completeds",JSON.stringify(t))}function GetTodos(){let e=[],t=[];localStorage.getItem("todos")&&(e=JSON.parse(localStorage.getItem("todos"))),localStorage.getItem("completeds")?(t=JSON.parse(localStorage.getItem("completeds")),document.title=`${e.length-t.length} Tarefas em aberto`):document.title="0 Tarefas em aberto",e.forEach((e,o)=>{-1!==t.indexOf(o)?todoList.appendChild(CreateTodoDiv(e,!0)):todoList.appendChild(CreateTodoDiv(e))})}document.addEventListener("DOMContentLoaded",GetTodos),todoButton.addEventListener("click",AddTodo),todoList.addEventListener("click",HandlerActions),filterOption.addEventListener("change",FilterTodo);